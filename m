Return-Path: <linux-pm+bounces-29826-lists+linux-pm=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-pm@lfdr.de
Delivered-To: lists+linux-pm@lfdr.de
Received: from am.mirrors.kernel.org (am.mirrors.kernel.org [IPv6:2604:1380:4601:e00::3])
	by mail.lfdr.de (Postfix) with ESMTPS id 78F99AED95A
	for <lists+linux-pm@lfdr.de>; Mon, 30 Jun 2025 12:07:15 +0200 (CEST)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by am.mirrors.kernel.org (Postfix) with ESMTPS id 8D4ED18892EB
	for <lists+linux-pm@lfdr.de>; Mon, 30 Jun 2025 10:07:31 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 3010924C67A;
	Mon, 30 Jun 2025 10:07:11 +0000 (UTC)
X-Original-To: linux-pm@vger.kernel.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id AA7FE24A041;
	Mon, 30 Jun 2025 10:07:09 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=217.140.110.172
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1751278031; cv=none; b=WKkKAPd8tQqBmVarO699OttEW5Om7JIvqFp766GLOKMfultChK74eEYrCg83127xj4DXvr+Mekw/kIrDIwnPzuc37gD1/qf+jD7QmmMgvYZVhKxvtBpBA31oUoRDaF5q9viCz1ryLLTxmdE+zhlgJv3SHNKNsMAX72GlWDZFVDc=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1751278031; c=relaxed/simple;
	bh=BBC7Jiocg90QkWAgP3ev2DTS4q8/YMW6mfcj5aBowm4=;
	h=Message-ID:Date:MIME-Version:Subject:To:Cc:References:From:
	 In-Reply-To:Content-Type; b=aoN6Q4laJkENMK+Z4X1SFWKs9/LXoMe317PG/rTbNYTdAa3GkAy+NaabkkNAgElksxklStr8H3viMbwxm0nPuPMyCQhUDhcAVUInSRiqO/5f5DA594kQw5QUKLSmBoPDVcihhIYVbr790oYmmL1QGGHc4s5NuUjQxCiqTdTFi4g=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=arm.com; spf=pass smtp.mailfrom=arm.com; arc=none smtp.client-ip=217.140.110.172
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=arm.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=arm.com
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
	by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 3521E1D34;
	Mon, 30 Jun 2025 03:06:53 -0700 (PDT)
Received: from [10.57.85.50] (unknown [10.57.85.50])
	by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id DADD13F58B;
	Mon, 30 Jun 2025 03:07:06 -0700 (PDT)
Message-ID: <5afe2400-659d-40d8-ab4f-33a1b250ac85@arm.com>
Date: Mon, 30 Jun 2025 11:07:12 +0100
Precedence: bulk
X-Mailing-List: linux-pm@vger.kernel.org
List-Id: <linux-pm.vger.kernel.org>
List-Subscribe: <mailto:linux-pm+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-pm+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
User-Agent: Mozilla Thunderbird
Subject: Re: [PATCH v2 00/10] PM: EM: Add netlink support for the energy
 model.
To: Changwoo Min <changwoo@igalia.com>
Cc: christian.loehle@arm.com, tj@kernel.org, pavel@kernel.org,
 len.brown@intel.com, rafael@kernel.org, kernel-dev@igalia.com,
 linux-pm@vger.kernel.org, sched-ext@lists.linux.dev,
 linux-kernel@vger.kernel.org, "Rafael J. Wysocki"
 <rafael.j.wysocki@intel.com>
References: <20250613094428.267791-1-changwoo@igalia.com>
 <b74f6484-dd16-430a-bad9-4dca6384d1dc@igalia.com>
Content-Language: en-US
From: Lukasz Luba <lukasz.luba@arm.com>
In-Reply-To: <b74f6484-dd16-430a-bad9-4dca6384d1dc@igalia.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Hi Changwoo,

On 6/27/25 04:37, Changwoo Min wrote:
> Gentle ping as it reaches 2-weeks.

My apologies for delay on that topic.

Let me have a look into this...

> 
> @Lukasz, @Rafael -- I have a question related to the energy model
> in general. As far as I understand, the energy model describes
> the performance-energy consumption tradeoff when a single CPU in
> a performance domain is running. However, in reality, SoCs may
> have thermal constraints, which would result in additional
> constraints. For example, running all CPUs with the highest
> frequency may not be possible. My question is this: does kernel
> maintain and use such (thermal?) constraints?

That's true in real scenarios on mobile SoCs, running with max freq
on all CPUs is possible likely only for short period...

The Energy Model itself doesn't handle such situation. The code in
thermal framework and in Energy Aware Scheduler has feature to handle
it and know which top OPPs are not possible to be used.

Although, the EM in such situation is likely to be adjusted, because the
SoC temperature reaches high values. Especially if that heat was
generated by the GPU not CPUs themselves, then it's extra leakage will
be accounted and EM data modified in runtime.

Another scenario when the EM might be updated is when Middleware
will recognize a known 'scenario' e.g. long video conference
with camera in use (thus Image Signal Processor, which also can
heat the SoC, like GPU). Or a 'preferred profile' for light-weight
application using some HW decoding, e.g. video playback and
thus some CPUs are more preferred by EAS to be used in it (EM might
change the energy efficiency gently for such CPUs).

Regards,
Lukasz

