Return-Path: <linux-pm-owner@vger.kernel.org>
X-Original-To: lists+linux-pm@lfdr.de
Delivered-To: lists+linux-pm@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id DEBB540C8A0
	for <lists+linux-pm@lfdr.de>; Wed, 15 Sep 2021 17:45:07 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S238094AbhIOPqZ (ORCPT <rfc822;lists+linux-pm@lfdr.de>);
        Wed, 15 Sep 2021 11:46:25 -0400
Received: from smtp-fw-6001.amazon.com ([52.95.48.154]:30840 "EHLO
        smtp-fw-6001.amazon.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S234294AbhIOPqX (ORCPT
        <rfc822;linux-pm@vger.kernel.org>); Wed, 15 Sep 2021 11:46:23 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
  d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
  t=1631720706; x=1663256706;
  h=date:from:to:cc:subject:message-id:references:
   mime-version:in-reply-to:content-transfer-encoding;
  bh=viMjeoV7tPseMYelykhO0DlocEjVAxRUKVeHJAZT68U=;
  b=JGTurBpopqYsAuUxf9By4nGTyRPpD7XV/1aAHrUI1IFUfrqJ2udg0Lfm
   97tb8N4KtB/yXLsnEebJQSsDl9AYawKcIcTbXevBk8mdFD33OirAzQlDg
   oz/Lv6dDMkK/cQpkf8xloLo0Hizr+sf376Vjd/H+1INJUxOi5VlFkFizn
   0=;
X-IronPort-AV: E=Sophos;i="5.85,295,1624320000"; 
   d="scan'208";a="141985187"
Received: from iad12-co-svc-p1-lb1-vlan3.amazon.com (HELO email-inbound-relay-1a-807d4a99.us-east-1.amazon.com) ([10.43.8.6])
  by smtp-border-fw-6001.iad6.amazon.com with ESMTP; 15 Sep 2021 15:44:56 +0000
Received: from EX13D39EUC004.ant.amazon.com (iad12-ws-svc-p26-lb9-vlan3.iad.amazon.com [10.40.163.38])
        by email-inbound-relay-1a-807d4a99.us-east-1.amazon.com (Postfix) with ESMTPS id 824CBA1FB1;
        Wed, 15 Sep 2021 15:44:45 +0000 (UTC)
Received: from EX13MTAUWA001.ant.amazon.com (10.43.160.58) by
 EX13D39EUC004.ant.amazon.com (10.43.164.239) with Microsoft SMTP Server (TLS)
 id 15.0.1497.23; Wed, 15 Sep 2021 15:44:44 +0000
Received: from dev-dsk-anelkz-1b-031e727b.eu-west-1.amazon.com (10.13.225.27)
 by mail-relay.amazon.com (10.43.160.118) with Microsoft SMTP Server id
 15.0.1497.23 via Frontend Transport; Wed, 15 Sep 2021 15:44:42 +0000
Received: by dev-dsk-anelkz-1b-031e727b.eu-west-1.amazon.com (Postfix, from userid 14141144)
        id 3C07F2E22; Wed, 15 Sep 2021 15:44:41 +0000 (UTC)
Date:   Wed, 15 Sep 2021 15:44:41 +0000
From:   Anel Orazgaliyeva <anelkz@amazon.de>
To:     "Rafael J. Wysocki" <rafael@kernel.org>
CC:     Aman Priyadarshi <apeureka@amazon.de>,
        Daniel Lezcano <daniel.lezcano@linaro.org>,
        <linux-pm@vger.kernel.org>, <linux-kernel@vger.kernel.org>
Subject: Re: [PATCH] cpuidle: Fix memory leaks
Message-ID: <20210915154440.GA34487@dev-dsk-anelkz-1b-031e727b.eu-west-1.amazon.com>
References: <20210906183440.85710-1-anelkz@amazon.de>
 <CAJZ5v0ghTGx_1Y5R07pJ9CkTxrMjs=nj2UefeJn6Yh5ud2uP2A@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
In-Reply-To: <CAJZ5v0ghTGx_1Y5R07pJ9CkTxrMjs=nj2UefeJn6Yh5ud2uP2A@mail.gmail.com>
User-Agent: Mutt/1.5.21 (2010-09-15)
Content-Transfer-Encoding: base64
Precedence: bulk
List-ID: <linux-pm.vger.kernel.org>
X-Mailing-List: linux-pm@vger.kernel.org

PiBPbiBXZWQsIFNlcCAxNSwgMjAyMSBhdCAwMjoxNDo1NlBNICswMjAwLCBSYWZhZWwgSi4gV3lz
b2NraSB3cm90ZToKPiBDQVVUSU9OOiBUaGlzIGVtYWlsIG9yaWdpbmF0ZWQgZnJvbSBvdXRzaWRl
IG9mIHRoZSBvcmdhbml6YXRpb24uIERvIG5vdCBjbGljayBsaW5rcyBvciBvcGVuIGF0dGFjaG1l
bnRzIHVubGVzcyB5b3UgY2FuIGNvbmZpcm0gdGhlIHNlbmRlciBhbmQga25vdyB0aGUgY29udGVu
dCBpcyBzYWZlLgo+IAo+IAo+IAo+IE9uIE1vbiwgU2VwIDYsIDIwMjEgYXQgODozNSBQTSBBbmVs
IE9yYXpnYWxpeWV2YSA8YW5lbGt6QGFtYXpvbi5kZT4gd3JvdGU6Cj4gPgo+ID4gQ29tbWl0IGMz
NDNiZjFiYTVlZiAoImNwdWlkbGU6IEZpeCB0aHJlZSByZWZlcmVuY2UgY291bnQgbGVha3MiKQo+
ID4gZml4ZXMgdGhlIGNsZWFudXAgb2Yga29iamVjdHM7IGhvd2V2ZXIsIGl0IHJlbW92ZXMga2Zy
ZWUoKSBjYWxscwo+ID4gYWx0b2dldGhlciwgbGVhZGluZyB0byBtZW1vcnkgbGVha3MuCj4gCj4g
V2FpdCwgd29uJ3QgdGhlIGNsZWFudXAgYmUgZG9uZSBieSBjcHVpZGxlX2ZyZWVfc3RhdGVfa29i
aigpPwoKRm9yIHN0YXRlIGNsZWFudXAsIGNwdWlkbGVfZnJlZV9zdGF0ZV9rb2JqKCkgaXMgY2Fs
bGVkIG9uIHRoZSBhbGwgdGhlIHByZXZpb3VzbHkgY3JlYXRlZCBrb2JqczoKCmVycm9yX3N0YXRl
OgogICAgICAgIGZvciAoaSA9IGkgLSAxOyBpID49IDA7IGktLSkKICAgICAgICAgICAgICAgIGNw
dWlkbGVfZnJlZV9zdGF0ZV9rb2JqKGRldmljZSwgaSk7CgpzbyB3ZSBzdGlsbCBuZWVkIHRvIGNs
ZWFudXAgdGhlIGtvYmogY3JlYXRlZCBpbiB0aGUgY3VycmVudCBpdGVyYXRpb24uCgoKRm9yIG92
ZXJhbGwgc3lzZnMsIHRoZSBmbG93IGlzIGFzIGZvbGxvd3M6CgpjcHVpZGxlX3JlZ2lzdGVyX2Rl
dmljZQogICAgIHJldCA9IGNwdWlkbGVfYWRkX3N5c2ZzKGRldik7CiAgICBpZiAocmV0KQogICAg
ICAgIGdvdG8gb3V0X3VucmVnaXN0ZXI7CgpvdXRfdW5yZWdpc3RlcjoKICAgIF9fY3B1aWRsZV91
bnJlZ2lzdGVyX2RldmljZShkZXYpOwogICBnb3RvIG91dF91bmxvY2s7CgpzbyB3aGVuIHRoZXJl
IGlzIGFuIGVycm9yIGluIGNwdWlkbGVfYWRkX3N5c2ZzKCkgZGV2IGRvZXNu4oCZdCBnZXQgZnJl
ZWQuCgo+IAo+ID4gRml4IHRob3NlIGFuZCBhbHNvIGRlZmVyIHRoZSBpbml0aWFsaXphdGlvbiBv
ZiBkZXYtPmtvYmpfZGV2IHVudGlsCj4gPiBhZnRlciB0aGUgZXJyb3IgY2hlY2ssIHNvIHRoYXQg
d2UgZG8gbm90IGVuZCB1cCB3aXRoIGEgZGFuZ2xpbmcKPiA+IHBvaW50ZXIuCj4gPgo+ID4gU2ln
bmVkLW9mZi1ieTogQW5lbCBPcmF6Z2FsaXlldmEgPGFuZWxrekBhbWF6b24uZGU+Cj4gPiBTdWdn
ZXN0ZWQtYnk6IEFtYW4gUHJpeWFkYXJzaGkgPGFwZXVyZWthQGFtYXpvbi5kZT4KPiA+IC0tLQo+
ID4gIGRyaXZlcnMvY3B1aWRsZS9zeXNmcy5jIHwgNSArKysrLQo+ID4gIDEgZmlsZSBjaGFuZ2Vk
LCA0IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKPiA+Cj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9jcHVpZGxlL3N5c2ZzLmMgYi9kcml2ZXJzL2NwdWlkbGUvc3lzZnMuYwo+ID4gaW5kZXgg
NTNlYzk1ODVjY2Q0Li40NjllMTg1NDdkMDYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2NwdWlk
bGUvc3lzZnMuYwo+ID4gKysrIGIvZHJpdmVycy9jcHVpZGxlL3N5c2ZzLmMKPiA+IEBAIC00ODgs
NiArNDg4LDcgQEAgc3RhdGljIGludCBjcHVpZGxlX2FkZF9zdGF0ZV9zeXNmcyhzdHJ1Y3QgY3B1
aWRsZV9kZXZpY2UgKmRldmljZSkKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAma2Rldi0+a29iaiwgInN0YXRlJWQiLCBpKTsKPiA+ICAgICAgICAgICAgICAg
ICBpZiAocmV0KSB7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICBrb2JqZWN0X3B1dCgma29i
ai0+a29iaik7Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICBrZnJlZShrb2JqKTsKPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyb3Jfc3RhdGU7Cj4gPiAgICAgICAgICAgICAg
ICAgfQo+ID4gICAgICAgICAgICAgICAgIGNwdWlkbGVfYWRkX3MyaWRsZV9hdHRyX2dyb3VwKGtv
YmopOwo+ID4gQEAgLTYxOSw2ICs2MjAsNyBAQCBzdGF0aWMgaW50IGNwdWlkbGVfYWRkX2RyaXZl
cl9zeXNmcyhzdHJ1Y3QgY3B1aWRsZV9kZXZpY2UgKmRldikKPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJmtkZXYtPmtvYmosICJkcml2ZXIiKTsKPiA+ICAgICAgICAgaWYg
KHJldCkgewo+ID4gICAgICAgICAgICAgICAgIGtvYmplY3RfcHV0KCZrZHJ2LT5rb2JqKTsKPiA+
ICsgICAgICAgICAgICAgICBrZnJlZShrZHJ2KTsKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4g
cmV0Owo+ID4gICAgICAgICB9Cj4gPgo+ID4gQEAgLTcwNSw3ICs3MDcsNiBAQCBpbnQgY3B1aWRs
ZV9hZGRfc3lzZnMoc3RydWN0IGNwdWlkbGVfZGV2aWNlICpkZXYpCj4gPiAgICAgICAgIGlmICgh
a2RldikKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ICAgICAgICAga2Rl
di0+ZGV2ID0gZGV2Owo+ID4gLSAgICAgICBkZXYtPmtvYmpfZGV2ID0ga2RldjsKPiA+Cj4gPiAg
ICAgICAgIGluaXRfY29tcGxldGlvbigma2Rldi0+a29ial91bnJlZ2lzdGVyKTsKPiA+Cj4gPiBA
QCAtNzEzLDkgKzcxNCwxMSBAQCBpbnQgY3B1aWRsZV9hZGRfc3lzZnMoc3RydWN0IGNwdWlkbGVf
ZGV2aWNlICpkZXYpCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjcHVp
ZGxlIik7Cj4gPiAgICAgICAgIGlmIChlcnJvcikgewo+ID4gICAgICAgICAgICAgICAgIGtvYmpl
Y3RfcHV0KCZrZGV2LT5rb2JqKTsKPiA+ICsgICAgICAgICAgICAgICBrZnJlZShrZGV2KTsKPiA+
ICAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3I7Cj4gPiAgICAgICAgIH0KPiA+Cj4gPiArICAg
ICAgIGRldi0+a29ial9kZXYgPSBrZGV2Owo+ID4gICAgICAgICBrb2JqZWN0X3VldmVudCgma2Rl
di0+a29iaiwgS09CSl9BREQpOwo+ID4KPiA+ICAgICAgICAgcmV0dXJuIDA7Cj4gPiAtLQo+ID4g
Mi4zMi4wCj4gPgo+ID4KPiA+Cj4gPgo+ID4gQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJt
YW55IEdtYkgKPiA+IEtyYXVzZW5zdHIuIDM4Cj4gPiAxMDExNyBCZXJsaW4KPiA+IEdlc2NoYWVm
dHNmdWVocnVuZzogQ2hyaXN0aWFuIFNjaGxhZWdlciwgSm9uYXRoYW4gV2Vpc3MKPiA+IEVpbmdl
dHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgo+
ID4gU2l0ejogQmVybGluCj4gPiBVc3QtSUQ6IERFIDI4OSAyMzcgODc5CgpPbiBXZWQsIFNlcCAx
NSwgMjAyMSBhdCAwMjoxNDo1NlBNICswMjAwLCBSYWZhZWwgSi4gV3lzb2NraSB3cm90ZToKPiBD
QVVUSU9OOiBUaGlzIGVtYWlsIG9yaWdpbmF0ZWQgZnJvbSBvdXRzaWRlIG9mIHRoZSBvcmdhbml6
YXRpb24uIERvIG5vdCBjbGljayBsaW5rcyBvciBvcGVuIGF0dGFjaG1lbnRzIHVubGVzcyB5b3Ug
Y2FuIGNvbmZpcm0gdGhlIHNlbmRlciBhbmQga25vdyB0aGUgY29udGVudCBpcyBzYWZlLgo+IAo+
IAo+IAo+IE9uIE1vbiwgU2VwIDYsIDIwMjEgYXQgODozNSBQTSBBbmVsIE9yYXpnYWxpeWV2YSA8
YW5lbGt6QGFtYXpvbi5kZT4gd3JvdGU6Cj4gPgo+ID4gQ29tbWl0IGMzNDNiZjFiYTVlZiAoImNw
dWlkbGU6IEZpeCB0aHJlZSByZWZlcmVuY2UgY291bnQgbGVha3MiKQo+ID4gZml4ZXMgdGhlIGNs
ZWFudXAgb2Yga29iamVjdHM7IGhvd2V2ZXIsIGl0IHJlbW92ZXMga2ZyZWUoKSBjYWxscwo+ID4g
YWx0b2dldGhlciwgbGVhZGluZyB0byBtZW1vcnkgbGVha3MuCj4gCj4gV2FpdCwgd29uJ3QgdGhl
IGNsZWFudXAgYmUgZG9uZSBieSBjcHVpZGxlX2ZyZWVfc3RhdGVfa29iaigpPwo+IAo+ID4gRml4
IHRob3NlIGFuZCBhbHNvIGRlZmVyIHRoZSBpbml0aWFsaXphdGlvbiBvZiBkZXYtPmtvYmpfZGV2
IHVudGlsCj4gPiBhZnRlciB0aGUgZXJyb3IgY2hlY2ssIHNvIHRoYXQgd2UgZG8gbm90IGVuZCB1
cCB3aXRoIGEgZGFuZ2xpbmcKPiA+IHBvaW50ZXIuCj4gPgo+ID4gU2lnbmVkLW9mZi1ieTogQW5l
bCBPcmF6Z2FsaXlldmEgPGFuZWxrekBhbWF6b24uZGU+Cj4gPiBTdWdnZXN0ZWQtYnk6IEFtYW4g
UHJpeWFkYXJzaGkgPGFwZXVyZWthQGFtYXpvbi5kZT4KPiA+IC0tLQo+ID4gIGRyaXZlcnMvY3B1
aWRsZS9zeXNmcy5jIHwgNSArKysrLQo+ID4gIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMo
KyksIDEgZGVsZXRpb24oLSkKPiA+Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jcHVpZGxlL3N5
c2ZzLmMgYi9kcml2ZXJzL2NwdWlkbGUvc3lzZnMuYwo+ID4gaW5kZXggNTNlYzk1ODVjY2Q0Li40
NjllMTg1NDdkMDYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2NwdWlkbGUvc3lzZnMuYwo+ID4g
KysrIGIvZHJpdmVycy9jcHVpZGxlL3N5c2ZzLmMKPiA+IEBAIC00ODgsNiArNDg4LDcgQEAgc3Rh
dGljIGludCBjcHVpZGxlX2FkZF9zdGF0ZV9zeXNmcyhzdHJ1Y3QgY3B1aWRsZV9kZXZpY2UgKmRl
dmljZSkKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAma2Rl
di0+a29iaiwgInN0YXRlJWQiLCBpKTsKPiA+ICAgICAgICAgICAgICAgICBpZiAocmV0KSB7Cj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICBrb2JqZWN0X3B1dCgma29iai0+a29iaik7Cj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICBrZnJlZShrb2JqKTsKPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gZXJyb3Jfc3RhdGU7Cj4gPiAgICAgICAgICAgICAgICAgfQo+ID4gICAgICAg
ICAgICAgICAgIGNwdWlkbGVfYWRkX3MyaWRsZV9hdHRyX2dyb3VwKGtvYmopOwo+ID4gQEAgLTYx
OSw2ICs2MjAsNyBAQCBzdGF0aWMgaW50IGNwdWlkbGVfYWRkX2RyaXZlcl9zeXNmcyhzdHJ1Y3Qg
Y3B1aWRsZV9kZXZpY2UgKmRldikKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJmtkZXYtPmtvYmosICJkcml2ZXIiKTsKPiA+ICAgICAgICAgaWYgKHJldCkgewo+ID4gICAg
ICAgICAgICAgICAgIGtvYmplY3RfcHV0KCZrZHJ2LT5rb2JqKTsKPiA+ICsgICAgICAgICAgICAg
ICBrZnJlZShrZHJ2KTsKPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ID4gICAgICAg
ICB9Cj4gPgo+ID4gQEAgLTcwNSw3ICs3MDcsNiBAQCBpbnQgY3B1aWRsZV9hZGRfc3lzZnMoc3Ry
dWN0IGNwdWlkbGVfZGV2aWNlICpkZXYpCj4gPiAgICAgICAgIGlmICgha2RldikKPiA+ICAgICAg
ICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+ICAgICAgICAga2Rldi0+ZGV2ID0gZGV2Owo+
ID4gLSAgICAgICBkZXYtPmtvYmpfZGV2ID0ga2RldjsKPiA+Cj4gPiAgICAgICAgIGluaXRfY29t
cGxldGlvbigma2Rldi0+a29ial91bnJlZ2lzdGVyKTsKPiA+Cj4gPiBAQCAtNzEzLDkgKzcxNCwx
MSBAQCBpbnQgY3B1aWRsZV9hZGRfc3lzZnMoc3RydWN0IGNwdWlkbGVfZGV2aWNlICpkZXYpCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjcHVpZGxlIik7Cj4gPiAgICAg
ICAgIGlmIChlcnJvcikgewo+ID4gICAgICAgICAgICAgICAgIGtvYmplY3RfcHV0KCZrZGV2LT5r
b2JqKTsKPiA+ICsgICAgICAgICAgICAgICBrZnJlZShrZGV2KTsKPiA+ICAgICAgICAgICAgICAg
ICByZXR1cm4gZXJyb3I7Cj4gPiAgICAgICAgIH0KPiA+Cj4gPiArICAgICAgIGRldi0+a29ial9k
ZXYgPSBrZGV2Owo+ID4gICAgICAgICBrb2JqZWN0X3VldmVudCgma2Rldi0+a29iaiwgS09CSl9B
REQpOwo+ID4KPiA+ICAgICAgICAgcmV0dXJuIDA7Cj4gPiAtLQo+ID4gMi4zMi4wCj4gPgo+ID4K
PiA+Cj4gPgo+ID4gQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKPiA+IEty
YXVzZW5zdHIuIDM4Cj4gPiAxMDExNyBCZXJsaW4KPiA+IEdlc2NoYWVmdHNmdWVocnVuZzogQ2hy
aXN0aWFuIFNjaGxhZWdlciwgSm9uYXRoYW4gV2Vpc3MKPiA+IEVpbmdldHJhZ2VuIGFtIEFtdHNn
ZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgo+ID4gU2l0ejogQmVybGlu
Cj4gPiBVc3QtSUQ6IERFIDI4OSAyMzcgODc5Cj4gPgo+ID4KPiA+CgoKCkFtYXpvbiBEZXZlbG9w
bWVudCBDZW50ZXIgR2VybWFueSBHbWJICktyYXVzZW5zdHIuIDM4CjEwMTE3IEJlcmxpbgpHZXNj
aGFlZnRzZnVlaHJ1bmc6IENocmlzdGlhbiBTY2hsYWVnZXIsIEpvbmF0aGFuIFdlaXNzCkVpbmdl
dHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgpT
aXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCg==

